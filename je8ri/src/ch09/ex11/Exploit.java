package ch09.ex11;

import java.io.IOException;
import java.io.InputStream;

public class Exploit {
	public InputStream RCE(String[] command) throws IOException, InterruptedException {
		ProcessBuilder pb = new ProcessBuilder(command);
		Process process = pb.start();

		int exitCode = process.waitFor();

		if(exitCode == 0) {
			return process.getInputStream();
		} else {
			return process.getErrorStream();
		}
	}
}
